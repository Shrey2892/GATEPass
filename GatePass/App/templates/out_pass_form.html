<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Out Pass Request</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'assets/css/style.css' %}">

    <link rel="stylesheet" href="{% static 'assets/vendor/bootstrap/css/bootstrap.min.css'%}">
    <link rel="stylesheet" href="{% static 'assets/vendor/bootstrap-icons/bootstrap-icons.css'%}">
    <link rel="stylesheet" href="{% static 'assets/vendor/boxicons/css/boxicons.min.css'%}">
    <link rel="stylesheet" href="{% static 'assets/vendor/quill/quill.snow.css'%}">
    <link rel="stylesheet" href="{% static 'assets/vendor/quill/quill.bubble.css'%}">
    <link rel="stylesheet" href="{% static 'assets/vendor/remixicon/remixicon.css'%}">
    <link rel="stylesheet" href="{% static 'assets/vendor/simple-datatables/style.css'%}">

    <!-- Template Main CSS File -->
    <link rel="stylesheet" href="{% static 'assets/css/style.css'%}">

</head>

<body>
    <h1>Request an Out Pass</h1>
    <form method="post" action="{% url 'request_out_pass' %}" id="out-pass-form">
        {% csrf_token %}
        <div>
            <label for="gatepassno">Gate Pass No:</label>
            <input type="text" id="gatepassno" name="gatepassno" required>
        </div>
        <div>
            <label for="user_name">Name:</label>
            <input type="text" id="user_name" name="user_name" required>
        </div>
        <div>
            <label for="purpose">Purpose:</label>
            <input type="text" id="purpose" name="purpose" required>
        </div>
        <button type="submit">Submit</button>
    </form>

    <script>
        $(document).ready(function () {
            $('#gatepassno').on('blur', function () {
                var gatepassno = $(this).val();
                if (gatepassno) {
                    $.ajax({
                        url: "{% url 'get_gate_pass_data' %}",
                        data: {
                            'gatepassno': gatepassno
                        },
                        success: function (data) {
                            if (data.error) {
                                alert(data.error);
                            } else {
                                // Autofill form fields
                                $('#user_name').val(data.driver_name);
                                $('#purpose').val(data.purpose);
                                // Add other fields as needed
                            }
                        },
                        error: function (xhr) {
                            alert('Error: ' + xhr.responseJSON.error);
                        }
                    });
                }
            });
        });
    </script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="{% static 'assets/vendor/apexcharts/apexcharts.min.js' %}"></script>
    <script src="{% static 'assets/vendor/bootstrap/js/bootstrap.bundle.min.js'%}"></script>
    <script src="{% static 'assets/vendor/chart.js/chart.umd.js'%}"></script>
    <script src="{% static 'assets/vendor/echarts/echarts.min.js'%}"></script>
    <script src="{% static 'assets/vendor/quill/quill.js'%}"></script>
    <script src="{% static 'assets/vendor/simple-datatables/simple-datatables.js'%}"></script>
    <script src="{% static 'assets/vendor/tinymce/tinymce.min.js'%}"></script>
    <script src="{% static 'assets/vendor/php-email-form/validate.js'%}"></script>
  
    <!-- Template Main JS File -->
    <script src="{% static 'assets/js/main.js'%}"></script>
</body>

</html>